<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <meta content="A multi-step form is a long-form broken down into multiple pieces/steps to make an otherwise long form less intimidating for visitors to complete." name="description">
    <meta content="Sam Norton" name="author">
    <title>資通安全成熟度評鑑系統</title>
    <!-- FAVICONS -->
    <link href="favicons/apple-icon-57x57.png" rel="apple-touch-icon" sizes="57x57">
    <link href="favicons/apple-icon-60x60.png" rel="apple-touch-icon" sizes="60x60">
    <link href="favicons/apple-icon-72x72.png" rel="apple-touch-icon" sizes="72x72">
    <link href="favicons/apple-icon-76x76.png" rel="apple-touch-icon" sizes="76x76">
    <link href="favicons/apple-icon-114x114.png" rel="apple-touch-icon" sizes="114x114">
    <link href="favicons/apple-icon-120x120.png" rel="apple-touch-icon" sizes="120x120">
    <link href="favicons/apple-icon-144x144.png" rel="apple-touch-icon" sizes="144x144">
    <link href="favicons/apple-icon-152x152.png" rel="apple-touch-icon" sizes="152x152">
    <link href="favicons/apple-icon-180x180.png" rel="apple-touch-icon" sizes="180x180">
    <link href="favicons/android-icon-192x192.png" rel="icon" sizes="192x192" type="image/png">
    <link href="favicons/favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
    <link href="favicons/favicon-96x96.png" rel="icon" sizes="96x96" type="image/png">
    <link href="favicons/favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">
    <link href="/manifest.json" rel="manifest">
    <meta content="#ffffff" name="msapplication-TileColor">
    <meta content="favicons/ms-icon-144x144.png" name="msapplication-TileImage">
    <meta content="#ffffff" name="theme-color">
    <!-- CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    <!-- FONT -->
    <link href="https://fonts.gstatic.com" rel="preconnect">
    <link href="https://fonts.googleapis.com/css2?family=Josefin+Sans:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;1,200;1,300;1,400;1,500;1,600&display=swap" rel="stylesheet">
</head>
<body >

    <!-- CONTAINER -->
    <div id="app" :class="isLoaded"  class="container d-flex align-items-center min-vh-100">
        <div   class="row g-0 justify-content-center">
            <!-- TITLE -->
            <div class="col-lg-4 offset-lg-1 mx-0 px-0">
                <div id="title-container">
                    <img alt="" class="covid-image" src="./img/TTU.png">
                    <h2>資通安全成熟度評鑑系統</h2>
                    <h3>數位鑑識成熟度評鑑</h3>
                    <h3>共有6大領域19個問項</h3>
                    <p></p>
                </div>
            </div>
            <!-- FORMS -->
            <div class="col-lg-7 mx-0 px-0">
                <div class="progress">
                    <div aria-valuemax="100" aria-valuemin="0" aria-valuenow="50" class="progress-bar progress-bar-striped progress-bar-animated bg-danger" role="progressbar" style="width: 0%"></div>
                </div>
                <div id="qbox-container">
                    <v-form class="needs-validation" id="form-wrapper" method="post" name="form-wrapper" novalidate="" @submit.prevent  >
                        <div id="steps-container">
                            <div class="step" v-for="(value,key,index) in issueDataList" :key="value.seq" v-show="this.current_step == value.seq">
                                <h1>構面：{{ value.facet }}</h1>
                                <h4>{{ value.seq +'. '+ value.issue }}</h4>
                                <div class="form-check ps-0 q-box">
                                    <div class="q-box__question">
                                        <input class="form-check-input question__input" :id="'q_'+value.seq+'level_1'" :name="'q_'+value.seq" type="radio" value="1" v-model="value.score"> 
                                        <label class="form-check-label question__label" :for="'q_'+value.seq+'level_1'">{{value.level_1}}</label>
                                    </div>
                                    <div class="q-box__question">
                                        <input class="form-check-input question__input" :id="'q_'+value.seq+'level_2'" :name="'q_'+value.seq" type="radio" value="2" v-model="value.score"> 
                                        <label class="form-check-label question__label" :for="'q_'+value.seq+'level_2'">{{value.level_2}}</label>
                                    </div>
                                    <div class="q-box__question">
                                        <input class="form-check-input question__input" :id="'q_'+value.seq+'level_3'" :name="'q_'+value.seq" type="radio" value="3" v-model="value.score"> 
                                        <label class="form-check-label question__label" :for="'q_'+value.seq+'level_3'">{{value.level_3}}</label>
                                    </div>
                                    <div class="q-box__question">
                                        <input class="form-check-input question__input" :id="'q_'+value.seq+'level_4'" :name="'q_'+value.seq" type="radio" value="4" v-model="value.score"> 
                                        <label class="form-check-label question__label" :for="'q_'+value.seq+'level_4'">{{value.level_4}}</label>
                                    </div>
                                    <div class="q-box__question">
                                        <input class="form-check-input question__input" :id="'q_'+value.seq+'level_5'" :name="'q_'+value.seq" type="radio" value="5" v-model="value.score"> 
                                        <label class="form-check-label question__label" :for="'q_'+value.seq+'level_5'">{{value.level_5}}</label>
                                    </div>
                                </div>
                            </div>
                            <div class="step" v-show="this.current_step > stepCount && !isSuccess ">
                                <div class="mt-1">
                                    <div class="closing-text">
                                        <h4>感謝您耐心填完全部的資通安成熟度評鑑問項</h4>
                                        <p>我們將您所填的彙整報告，請耐心等待，謝謝</p>
                                        <p>Click on the submit button to continue.</p>
                                    </div>
                                </div>
                            </div>
                            <div id="success" v-show="isSuccess">
                                <div class="mt-5">
                                    <h4>資通安成熟度評鑑報告</h4>
                                    <p>資通安成熟度評鑑報告產生完成 <a href="report.html">請讀取報告</a> </p>
                                    <a class="back-link" href="">Go back from the beginning ➜</a>
                                </div>
                            </div>
                        </div>
                        <div id="q-box__buttons">
                            <button id="prev-btn" type="button" v-on:click="prevBtn" v-show="this.current_step > 1 " :class="{'d-none':isSuccess}">Previous</button> 
                            <button id="next-btn" type="button" v-on:click="nextBtn"  v-show="this.current_step < stepCount+1" :class="{'d-none':isSuccess}">Next</button> 
                            <button id="submit-btn" type="submit" v-on:click="submitBtn" v-show="this.current_step > stepCount && !isSuccess" >Submit</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <div id="preloader-wrapper" :class="isPreloader">
            <div id="preloader"></div>
            <div class="preloader-section section-left"></div>
            <div class="preloader-section section-right"></div>
        </div>
    </div><!-- PRELOADER -->

    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script>
        const { createApp } = Vue

        let  defData = {}


        var vm = createApp({
            data() {
                return {
                    issueDataList:[],
                    current_step:1,
                    isSuccess:false,
                    isLoaded:'',
                    isPreloader:''
                }
                },

            methods:{
                getIssueDate(){
                    fetch('./js/data.json')
                    .then((response) => response.json())
                    .then((json) => this.issueDataList=json);
                },
                nextBtn(){
                    this.current_step++
                },
                prevBtn(){
                    this.current_step--
                },
                submitBtn(){
                    this.isPreloader = 'd-block'
                    const timer = ms => new Promise(res => setTimeout(res, ms));
                    timer(3000)
                        .then(() => {
                            this.isLoaded='loaded'
                        }).then(() =>{
                            this.isPreloader = 'd-none'
                            this.isSuccess=true
                            
                            //寫到 local storage 
                            localStorage.setItem('fdfmesResult', JSON.stringify(this.issueDataList));

                        })
                }

            },

            computed: {
                stepCount :function(){
                    return this.issueDataList.length;
                },
            },

            mounted(){
                this.getIssueDate()
                localStorage.removeItem('fdfmesResult');
            }
            }).mount('#app') 
            
    </script>

</body>
</html>